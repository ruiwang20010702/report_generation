# Sentry 定价详解 - 不是只免费14天！

## ❓ 常见误解

**误解**：Sentry只免费14天  
**真相**：Sentry有**永久免费计划**！

---

## ✅ 正确理解

### 📅 Sentry免费计划时间线

```
注册 Sentry
    ↓
【第1-14天】Business 试用期
    - ✅ 所有高级功能
    - ✅ 无限 events
    - ✅ 无限团队成员
    - ✅ 高级集成
    ↓
【第15天开始】自动降级到 Developer 免费计划
    - ✅ 永久免费！
    - ✅ 5,000 errors/月
    - ✅ 1个项目
    - ✅ 1个用户
    - ✅ 基础功能完整
    - ✅ 保留7天数据
    ↓
【继续使用】
    - 完全免费，没有时间限制
    - 数据、配置全部保留
    - 够用！
```

---

## 💰 Sentry 定价详情（2024/2025）

### 🎁 Developer Plan（免费）- **永久**

| 特性 | 限制 |
|------|------|
| **价格** | **¥0 / 永久免费** |
| **Events** | 5,000 errors/月 |
| **项目数** | 1个 |
| **团队成员** | 1人 |
| **数据保留** | 7天 |
| **基础功能** | ✅ 完整 |
| **高级功能** | ❌ 不包含 |

✅ **适合**：
- 个人开发者
- 小型项目
- 开发/测试环境
- MVP阶段

💡 **5,000 errors/月够用吗？**
- 如果你的应用每天有10个独立错误
- 那么一个月 = 10 × 30 = 300个
- **完全够用！**

---

### 💼 Team Plan（付费）

| 特性 | 限制 |
|------|------|
| **价格** | **$29/月** 起 |
| **Events** | 50,000 errors/月 |
| **项目数** | 无限 |
| **团队成员** | 无限 |
| **数据保留** | 90天 |
| **高级功能** | ✅ 包含 |

✅ **适合**：
- 小团队
- 生产环境
- 需要更多events
- 需要团队协作

---

### 🏢 Business Plan（付费）

| 特性 | 限制 |
|------|------|
| **价格** | **$80/月** 起 |
| **Events** | 100,000 errors/月 |
| **高级功能** | ✅ 全部 |
| **优先支持** | ✅ 包含 |
| **SLA** | ✅ 99.9% |

✅ **适合**：
- 大型团队
- 企业应用
- 需要SLA保证

---

## 🎯 你的项目适合哪个计划？

### 场景1：现在（开发阶段）

**推荐**：不配置或免费Developer计划

```bash
# 方式1: 不配置（最省心）
# .env 中不设置 SENTRY_DSN

# 方式2: 免费计划
SENTRY_DSN=https://xxx@sentry.io/xxx
# 注册后自动是免费计划
```

✅ **理由**：
- 5,000 errors/月完全够用
- 零成本
- 专注核心功能开发

---

### 场景2：MVP上线（100用户以内）

**推荐**：继续免费Developer计划

✅ **理由**：
- 100用户产生的错误 < 5,000/月
- 节省成本
- 免费计划功能够用

---

### 场景3：快速增长（1000+用户）

**推荐**：根据实际需求决定

**选项A**：继续免费
- 如果errors < 5,000/月
- 继续免费

**选项B**：升级Team ($29/月)
- 如果errors > 5,000/月
- 或需要团队协作
- 或需要更长数据保留

**选项C**：切换到阿里云ARMS
- 国内访问快
- 稳定性更好
- 成本更可控

---

### 场景4：大规模（10000+用户）

**推荐**：阿里云ARMS 或 自建Sentry

✅ **理由**：
- 国内访问快
- 稳定性好
- 成本更优

---

## 💡 实用建议

### 1. 如何监控错误数量？

登录 Sentry 控制台：
- 查看 Stats 页面
- 查看当月已用 events
- 接近5,000时会收到邮件提醒

### 2. 超过5,000怎么办？

**选项1**：降低采样率

```typescript
// server/config/sentry.ts
Sentry.init({
  dsn: process.env.SENTRY_DSN,
  
  // 只采样50%的错误
  sampleRate: 0.5,
  
  // 或者过滤某些错误
  beforeSend(event) {
    // 忽略某些不重要的错误
    if (event.message?.includes('Network error')) {
      return null; // 不上传
    }
    return event;
  },
});
```

**选项2**：升级付费计划
- Team: $29/月（50,000 errors）
- 或按需购买额外events

**选项3**：切换到阿里云ARMS
- 100万次调用/月免费
- 国内访问快

### 3. 如何最大化免费额度？

✅ **智能过滤**：
```typescript
Sentry.init({
  dsn: process.env.SENTRY_DSN,
  
  beforeSend(event) {
    // 1. 过滤重复错误
    // 2. 忽略第三方错误
    // 3. 只上传关键错误
    
    // 例：忽略网络超时
    if (event.exception?.values?.[0]?.type === 'TimeoutError') {
      return null;
    }
    
    return event;
  },
  
  // 只在生产环境启用
  enabled: process.env.NODE_ENV === 'production',
});
```

✅ **采样策略**：
```typescript
Sentry.init({
  dsn: process.env.SENTRY_DSN,
  
  // 错误：100%上传（重要）
  sampleRate: 1.0,
  
  // 性能追踪：10%采样（可选）
  tracesSampleRate: 0.1,
});
```

---

## 📊 对比表：什么时候升级/切换？

| 指标 | 免费Developer | 付费Team | 阿里云ARMS |
|------|-------------|----------|-----------|
| **Events限制** | 5K/月 | 50K/月 | 100万/月 |
| **成本** | ¥0 | ¥200/月 | ¥0-几十元 |
| **国内速度** | 慢 | 慢 | 快 |
| **团队协作** | ❌ | ✅ | ✅ |
| **数据保留** | 7天 | 90天 | 自定义 |
| **推荐阶段** | 开发/MVP | 小团队 | 生产/增长 |

---

## ✅ 总结

### 核心要点

1. ⭐ **Sentry不是只免费14天！**
   - 前14天：Business试用（全功能）
   - 之后：**永久免费** Developer计划（5,000 errors/月）

2. ⭐ **5,000 errors/月够用吗？**
   - 开发阶段：完全够
   - MVP阶段：完全够
   - 小规模生产：通常够用
   - 大规模：考虑升级或切换

3. ⭐ **什么时候需要付费/切换？**
   - Errors > 5,000/月
   - 需要团队协作
   - 需要更长数据保留
   - 需要高级功能
   - 需要国内快速访问（切换ARMS）

---

## 🎯 现在的建议

**对于你的51Talk项目**：

```bash
# 阶段1：开发（现在）
# 不配置Sentry，专注核心功能

# 阶段2：测试
# 使用免费Sentry（5,000 errors/月完全够）

# 阶段3：上线初期
# 继续免费Sentry，监控错误数量

# 阶段4：如果errors接近5,000
# 选择：
# - 优化代码减少错误
# - 降低采样率
# - 升级付费计划 ($29/月)
# - 切换阿里云ARMS（推荐）
```

---

**记住**：Sentry免费计划是**永久的**，不是只有14天！🎉

查看完整指南：`docs/guides/SENTRY_CHINA_GUIDE.md`

